/*! sketch.js - v1.1.0 - 2013-05-08
* https://github.com/soulwire/sketch.js
* Copyright (c) 2013 Justin Windle (soulwire) Licensed MIT */
var Sketch=function(){"use strict";function l(l){function b(e,t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n]);return e}function w(e){function n(e,t){return function(){e.call(t,arguments)}}var t={};for(var r in e)typeof e[r]=="function"?t[r]=n(e[r],e):t[r]=e[r];return t}function E(e,t){e.length=0;for(var n=0,r=t.length;n<r;n++)e[n]=t[n];return e}function S(){function n(t){return e[t]||String.fromCharCode(t)}function r(e){c.mouse.ox=c.mouse.x,c.mouse.oy=c.mouse.y,c.mouse.x=e.x,c.mouse.y=e.y,c.mouse.dx=c.mouse.x-c.mouse.ox,c.mouse.dy=c.mouse.y-c.mouse.oy}function s(e){var t,n=w(e);n.original=e;for(var r=c.canvas,s=0,o=0;r;r=r.offsetParent)s+=r.offsetLeft,o+=r.offsetTop;if(n.touches&&!!n.touches.length)for(var u=n.touches.length-1,a;u>=0;u--)a=n.touches[u],a.x=a.pageX-s,a.y=a.pageY-o,t=i[u]||a,a.dx=a.x-t.x,a.dy=a.y-t.y,a.ox=t.x,a.oy=t.y,i[u]=w(a);else n.x=n.pageX-s,n.y=n.pageY-o,t=i.mouse||n,n.dx=n.x-t.x,n.dy=n.y-t.y,n.ox=t.x,n.oy=t.y,i.mouse=n;return n}function o(e){e.preventDefault(),e=s(e),E(c.touches,e.touches),r(c.touches[0]),c.touchstart&&c.touchstart(e),c.mousedown&&c.mousedown(e)}function u(e){e=s(e),E(c.touches,e.touches),r(c.touches[0]),c.touchmove&&c.touchmove(e),c.mousemove&&c.mousemove(e)}function l(e){e=s(e);if(!e.touches.length)i={};else for(var t in i)e.touches[t]||delete i[t];c.touchend&&c.touchend(e),c.mouseup&&c.mouseup(e)}function h(e){e=s(e),c.mouseover&&c.mouseover(e)}function p(e){e=s(e),c.dragging||(f(c.canvas,"mousemove",v),f(c.canvas,"mouseup",g),a(document,"mousemove",v),a(document,"mouseup",g),c.dragging=!0),E(c.touches,[e]),c.touchstart&&c.touchstart(e),c.mousedown&&c.mousedown(e)}function v(e){e=s(e),r(e),E(c.touches,[e]),c.touchmove&&c.touchmove(e),c.mousemove&&c.mousemove(e)}function m(e){e=s(e),c.mouseout&&c.mouseout(e)}function g(e){e=s(e),c.dragging&&(f(document,"mousemove",v),f(document,"mouseup",g),a(c.canvas,"mousemove",v),a(c.canvas,"mouseup",g),c.dragging=!1),delete i.mouse,c.touchend&&c.touchend(e),c.mouseup&&c.mouseup(e)}function y(e){e=s(e),c.click&&c.click(e)}function b(e){c.keys[n(e.keyCode)]=!0,c.keys[e.keyCode]=!0,c.keydown&&c.keydown(e)}function S(e){c.keys[n(e.keyCode)]=!1,c.keys[e.keyCode]=!1,c.keyup&&c.keyup(e)}var e={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"};for(var t in e)d.keys[e[t]]=!1;var i={};a(c.canvas,"touchstart",o),a(c.canvas,"touchmove",u),a(c.canvas,"touchend",l),a(c.canvas,"mouseover",h),a(c.canvas,"mousedown",p),a(c.canvas,"mousemove",v),a(c.canvas,"mouseout",m),a(c.canvas,"mouseup",g),a(c.canvas,"click",y),a(document,"keydown",b),a(document,"keyup",S),a(window,"resize",T)}function x(){if(!h){var e=Date.now();c.dt=e-c.now,c.millis+=c.dt,c.now=e,c.update&&c.update(c.dt),c.autoclear&&c.clear(),c.draw&&c.draw(c)}h=++h%c.interval,p=requestAnimationFrame(x)}function T(e){if(!c.autoresize)return;var n,i,s,o=c.type===r?c.style:c.canvas;c.fullscreen?(i=window.innerWidth*window.innerHeight,c.max_pixels&&i>c.max_pixels?(n=window.innerWidth/window.innerHeight,s=Math.sqrt(c.max_pixels/n),c.height=o.height=s,c.width=o.width=s*n,o.style.height=window.innerHeight+"px",o.style.width=window.innerWidth+"px"):(c.height=o.height=window.innerHeight,c.width=o.width=window.innerWidth)):(o.height=c.height,o.width=c.width);if(c.retina&&c.type===t&&window.devicePixelRatio){var u=o.height,a=o.width;c.canvas.height=u*window.devicePixelRatio,c.canvas.width=a*window.devicePixelRatio,c.scale(window.devicePixelRatio,window.devicePixelRatio),c.canvas.style.cssText="height: "+u+"px; width: "+a+"px;"}c.resize&&c.resize()}var c,h=0,p=-1,d={millis:0,now:NaN,dt:NaN,keys:{},mouse:{x:0,y:0,ox:0,oy:0,dx:0,dy:0},touches:[],initialized:!1,dragging:!1,running:!1,start:function(){if(c.running)return;c.setup&&!c.initialized&&(c.autopause&&(a(window,"focus",c.start),a(window,"blur",c.stop)),c.setup()),c.initialized=!0,c.running=!0,c.now=Date.now(),x()},stop:function(){cancelAnimationFrame(p),c.running=!1},toggle:function(){(c.running?c.stop:c.start)()},clear:function(){if(c.type===t||c.type===n)c.canvas.width=c.canvas.width,c.retina&&window.devicePixelRatio&&c.scale(window.devicePixelRatio,window.devicePixelRatio);else if(c.type===r){var e=c.canvas.childNodes;for(var i=0,s=e.length;i<s;i++)e[i].remove()}},destroy:function(){var e,t,n,r,o,u;s.splice(s.indexOf(c),1),c.stop();for(t in i){n=i[t];for(o=0,u=n.length;o<u;o++)e=n[o],f(e.el,t,e.fn);delete i[t]}c.container.removeChild(c.canvas);for(r in c)c.hasOwnProperty(r)&&delete c[r]}};l=b(l||{},o);var v="sketch-"+e++,m=l.hasOwnProperty("canvas"),g=m?l.canvas:document.createElement("canvas");switch(l.type){case n:try{c=g.getContext("webgl",l)}catch(y){}try{c=c||g.getContext("experimental-webgl",l)}catch(y){}if(!c)throw"WebGL not supported";break;case t:try{c=g.getContext("2d",l)}catch(y){}if(!c)throw"Canvas not supported";break;default:l.type=r,g=c=document.createElement("div")}return c.canvas=g,g.className="sketch",m?l.autoresize=!1:(l.container.appendChild(g),l.hasOwnProperty("autoresize")||(l.autoresize=o.autoresize),g.id=v),b(self,u),b(c,l),b(c,d),S(),l.autoresize&&T(),s.push(c),c.autostart&&setTimeout(c.start,0),c}var e=0,t="canvas",n="web-gl",r="dom",i={},s=[],o={fullscreen:!0,autostart:!0,autoclear:!0,autopause:!0,autoresize:!0,container:document.body,interval:1,type:t,retina:!1},u={PI:Math.PI,TWO_PI:Math.PI*2,HALF_PI:Math.PI/2,QUARTER_PI:Math.PI/4,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan2:Math.atan2,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,random:function(e,t){return e&&typeof e.length=="number"&&!!e.length?e[Math.floor(Math.random()*e.length)]:(typeof t!="number"&&(t=e||1,e=0),e+Math.random()*(t-e))}},a=function(){function e(e,t,n){i[t]||(i[t]=[]),i[t].push({el:e,fn:n})}return window.addEventListener?function(t,n,r){t.addEventListener(n,r,!1),e(t,n,r)}:window.attachEvent?function(t,n,r){t.attachEvent("on"+n,r),e(t,n,r)}:function(t,n,r){t["on"+n]=r,e(t,n,r)}}(),f=function(){function e(e,t,n){if(i[t]){var r;for(var s=i[t].length-1;s>=0;s--)r=i[t][s],r.el===e&&r.fn===n&&i[t].splice(s,1)}}if(window.removeEventListener)return function(t,n,r){t.removeEventListener(n,r,!1),e(t,n,r)};if(window.detachEvent)return function(t,n,r){t.detachEvent("on"+n,r),e(t,n,r)};el["on"+ev]=null,e(el,ev,fn)}();return{CANVAS:t,WEB_GL:n,DOM:r,instances:s,create:l}}();Date.now||(Date.now=function(){return+(new Date)}),function(){for(var e=0,t=["ms","moz","webkit","o"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(t){var n=Date.now(),r=Math.max(0,16-(n-e)),i=window.setTimeout(function(){t(n+r)},r);return e=n+r,i}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();