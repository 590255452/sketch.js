/* Copyright (C) 2013 Justin Windle, http://soulwire.co.uk */
var Sketch=function(){"use strict";function e(e){return"[object Array]"==Object.prototype.toString.call(e)}function t(e){return"function"==typeof e}function n(e){return"number"==typeof e}function r(e){return"string"==typeof e}function o(e){return C[e]||String.fromCharCode(e)}function i(e,t,n){for(var r in t)(n||!e.hasOwnProperty(r))&&(e[r]=t[r]);return e}function u(e,t){return function(){var n=e.apply(t,arguments);return void 0===n?t:n}}function a(e){var n={};for(var r in e)n[r]=t(e[r])?u(e[r],e):e[r];return n}function c(e){i(e,{set:function(t,n){r(t)?e[t]=n:i(e,t,!0)}});for(var n in e)t(e[n])&&(e[n]=u(e[n],e));return e}function l(e){function n(n){t(n)&&n.apply(e,[].splice.call(arguments,1))}function u(e){for(_=0;_<J.length;_++)G=J[_],r(G)?I[(e?"add":"remove")+"EventListener"].call(I,G,k,!1):t(G)?k=G:I=G}function c(){O(T),T=L(c),U||(n(e.setup),U=t(e.setup),n(e.resize)),e.running&&!j&&(e.dt=(B=+new Date)-e.now,e.millis+=e.dt,e.now=B,n(e.update),e.autoclear&&K&&e.clear(),n(e.draw)),j=++j%e.interval}function l(){I=Y?e.style:e.canvas,D=Y?"px":"",e.fullscreen&&(e.height=v.innerHeight,e.width=v.innerWidth),I.height=e.height+D,I.width=e.width+D,e.retina&&K&&X&&(I.height=e.height*X,I.width=e.width*X,I.style.height=e.height+"px",I.style.width=e.width+"px",e.scale(X,X)),U&&n(e.resize)}function s(e,t){return N=t.getBoundingClientRect(),e.x=e.pageX-N.left-v.scrollX,e.y=e.pageY-N.top-v.scrollY,e}function f(t,n){return s(t,e.element),n=n||{},n.ox=n.x||t.x,n.oy=n.y||t.y,n.x=t.x,n.y=t.y,n.dx=n.x-n.ox,n.dy=n.y-n.oy,n}function h(e){if(e.preventDefault(),W=a(e),W.originalEvent=e,W.touches)for(M.length=W.touches.length,_=0;_<W.touches.length;_++)M[_]=f(W.touches[_],M[_]);else M.length=0,M[0]=f(W,V);return i(V,M[0],!0),W}function g(t){for(t=h(t),q=(Q=J.indexOf(z=t.type))-1,e.dragging=/down|start/.test(z)?!0:/up|end/.test(z)?!1:e.dragging;q;)r(J[q])?n(e[J[q--]],t):r(J[Q])?n(e[J[Q++]],t):q=0}function d(t){F=t.keyCode,H="keyup"==t.type,Z[F]=Z[o(F)]=!H,n(e[t.type],t)}function m(t){e.autopause&&("blur"==t.type?b:E)(),n(e[t.type],t)}function E(){e.now=+new Date,e.running=!0}function b(){e.running=!1}function P(){(e.running?b:E)()}function A(){K&&e.clearRect(0,0,e.width,e.height)}function S(){R=e.element.parentNode,_=x.indexOf(e),R&&R.removeChild(e.element),~_&&x.splice(_,1),u(!1),b()}var T,k,I,R,N,_,D,B,G,W,z,F,H,q,Q,j=0,M=[],U=!1,X=v.devicePixelRatio,Y=e.type==y,K=e.type==p,V={x:0,y:0,ox:0,oy:0,dx:0,dy:0},J=[e.element,g,"mousedown","touchstart",g,"mousemove","touchmove",g,"mouseup","touchend",g,"click",w,d,"keydown","keyup",v,m,"focus","blur",l,"resize"],Z={};for(F in C)Z[C[F]]=!1;return x.push(i(e,{touches:M,mouse:V,keys:Z,dragging:!1,running:!1,millis:0,now:0/0,dt:0/0,destroy:S,toggle:P,clear:A,start:E,stop:b})),e.autostart&&E(),u(!0),l(),c(),e}for(var s,f,h="E LN10 LN2 LOG2E LOG10E PI SQRT1_2 SQRT2 abs acos asin atan ceil cos exp floor log round sin sqrt tan atan2 pow max min".split(" "),g="__hasSketch",d=Math,p="canvas",m="webgl",y="dom",w=document,v=window,x=[],E={fullscreen:!0,autostart:!0,autoclear:!0,autopause:!0,container:w.body,interval:1,globals:!0,retina:!1,chain:!1,type:p},C={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},b={CANVAS:p,WEB_GL:m,WEBGL:m,DOM:y,instances:x,install:function(t){if(!t[g]){for(var r=0;r<h.length;r++)t[h[r]]=d[h[r]];i(t,{TWO_PI:2*d.PI,HALF_PI:d.PI/2,QUATER_PI:d.PI/4,random:function(t,r){return e(t)?t[~~(d.random()*t.length)]:(n(r)||(r=t||1,t=0),t+d.random()*(r-t))},lerp:function(e,t,n){return e+n*(t-e)},map:function(e,t,n,r,o){return(e-t)/(n-t)*(o-r)+r}}),t[g]=!0}},create:function(e){return e=i(e||{},E),e.globals&&b.install(self),s=e.element=e.element||w.createElement(e.type===y?"div":"canvas"),f=e.context=e.context||function(){switch(e.type){case p:return s.getContext("2d",e);case m:return s.getContext("webgl",e)||s.getContext("experimental-webgl",e);case y:return s.canvas=s}}(),e.container.appendChild(s),b.augment(f,e)},augment:function(e,t){return t=i(t||{},E),t.chain&&c(e),t.element=e.canvas||e,t.element.className+=" sketch",i(e,t,!0),l(e)}},P=["ms","moz","webkit","o"],A=self,S=0,T="AnimationFrame",k="request"+T,I="cancel"+T,L=A[k],O=A[I],R=0;R<P.length&&!L;R++)L=A[P[R]+"Request"+T],O=A[P[R]+"Cancel"+k];return A[k]=L=L||function(e){var t=+new Date,n=d.max(0,16-(t-S)),r=setTimeout(function(){e(t+n)},n);return S=t+n,r},A[I]=O=O||function(e){clearTimeout(e)},b}();